<button
  type="button"
  class="trigger"
  [class.trigger_active]="isExpanded$ | async"
  [class.trigger_disabled]="isDisabled$ | async"
  [class.trigger_invalid]="isInvalid$ | async"
  (click)="processButtonClick()"
  cdkOverlayOrigin
  #overlayOrigin="cdkOverlayOrigin"
  #button
>
  <div class="trigger__text">
    <ng-container *ngIf="triggerValueIsVisible$ | async; else placeholder">
      <div class="tags-container" #tagsContainer>
        <div class="tag" *ngFor="let tag of renderTags$ | async; let count = count" [class.is-one]="count === 1">
          <ng-container
            [ngTemplateOutlet]="getSelectTriggerTagTemplateRef()"
            [ngTemplateOutletContext]="{ $implicit: tag }"
          ></ng-container>
        </div>
      </div>

      <div class="tags-counter" *ngIf="this.tagsOverflowCount$ | async as tagsOverflowCount">
        <pupa-tag [size]="'small'" [clickable]="true">+{{ tagsOverflowCount }}</pupa-tag>
      </div>
    </ng-container>
  </div>

  <div class="trigger__rotate-icon" [class.expanded]="isExpanded$ | async" (click)="toggleDropdown($event)">
    <pupa-icon name="ios-arrow-down"></pupa-icon>
  </div>
</button>

<ng-template #placeholder>
  <div class="placeholder" [class.on-hover]="placeholderIsVisibleOnHover$ | async">
    {{ placeholder$ | async }}
  </div>
</ng-template>

<ng-template #defaultTemplate let-tag>
  <pupa-tag class="default-tag"
    ><span class="deafult-tag__name">{{ tag }}</span></pupa-tag
  >
</ng-template>
