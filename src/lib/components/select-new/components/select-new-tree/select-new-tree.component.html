<ng-container *ngIf="isExpanded$ | async">
  <section
    class="select-tree-container"
    [style.height.px]="adaptiveTreeHeight$ | async"
    [ngSwitch]="type"
    (click)="processClick($event)"
  >
    <ng-container *ngSwitchCase="treeType.Flat" [ngTemplateOutlet]="flatTree"> </ng-container>
    <ng-container *ngSwitchCase="treeType.Hierarchical" [ngTemplateOutlet]="hierarchicalTree"> </ng-container>
    <ng-container *ngSwitchCase="treeType.Custom" [ngTemplateOutlet]="customTree"> </ng-container>
  </section>
</ng-container>

<ng-template #flatTree>
  <pupa-tree
    *ngIf="!(type | isNullOrUndefined)"
    [flatDataOrigin]="flatDataOrigin"
    [nodeTemplate]="nodeTemplate"
    [trackBy]="trackBy"
    [selectedNodesIds]="selectedNodesIds$ | async"
    [highlightedNodesIds]="highlightedNodesIds$ | async"
    [hideRoot]="hideRoot"
    [nodesWithoutPadding]="true"
    [isLoading]="isLoading"
    type="flat"
    class="tree"
    (expandedNode)="processNodeExpansion($event)"
    (visibleElementsCountChanged)="handleCountOfVisibleElementsChanges($event)"
  ></pupa-tree>
</ng-template>

<ng-template #hierarchicalTree>
  <pupa-tree
    *ngIf="!(type | isNullOrUndefined)"
    [treeNodesOrigin]="treeNodesOrigin"
    [treeElementsOrigin]="treeElementsOrigin"
    [nodeTemplate]="nodeTemplate"
    [trackBy]="trackBy"
    [selectedNodesIds]="selectedNodesIds$ | async"
    [highlightedNodesIds]="highlightedNodesIds$ | async"
    [hideRoot]="hideRoot"
    [nodesWithoutPadding]="true"
    [isLoading]="isLoading"
    type="hierarchical"
    class="tree"
    (expandedNode)="processNodeExpansion($event)"
    (visibleElementsCountChanged)="handleCountOfVisibleElementsChanges($event)"
  ></pupa-tree>
</ng-template>

<ng-template #customTree>
  <pupa-tree
    #customPupaTreeComponent
    *ngIf="!(type | isNullOrUndefined)"
    [nodeTemplate]="nodeTemplate"
    [trackBy]="trackBy"
    [selectedNodesIds]="selectedNodesIds$ | async"
    [highlightedNodesIds]="highlightedNodesIds$ | async"
    [hideRoot]="hideRoot"
    [nodesWithoutPadding]="true"
    [isLoading]="isLoading"
    type="custom"
    class="tree"
    (expandedNode)="processNodeExpansion($event)"
    (visibleElementsCountChanged)="handleCountOfVisibleElementsChanges($event)"
  ></pupa-tree>
</ng-template>

<ng-template #nodeTemplate let-node="node">
  <div class="select-tree-item-custom-template" (click)="processNodeClick(node)">
    {{ node?.name }}
  </div>
</ng-template>
