<div class="chip-select">
  <pupa-chip-button #addChips [disabled]="readonly">
    <div class="chip-select__chip-add-button">Добавить</div>
    <ion-icon name="add"></ion-icon>
  </pupa-chip-button>

  <pupa-chip *ngFor="let selectItem of selectItems; index as index">
    <div class="chip-select__chip-icon-container">
      <button
        *ngIf="!readonly"
        class="chip-select__chip-icon chip-select__chip-icon_remove"
        (click)="removeItem($event, selectItem)"
        title="Удалить"
        type="button"
      >
        <ion-icon name="trash"></ion-icon>
      </button>

      <ion-icon class="chip-select__chip-icon" *ngIf="selectItem?.icon" [name]="selectItem.icon"></ion-icon>
    </div>
    <span>{{ selectItem.value }}</span>
  </pupa-chip>

  <pupa-droppable
    *ngIf="!readonly"
    [anchor]="addChips.chipButtonElement.nativeElement"
    [maxWidth]="maxWidth"
    [positionChange$]="positionChange$"
  >
    <pupa-chip-select-tree
      *ngIf="items?.length > 0; else loader"
      [items]="items"
      (selectItemKey)="clickDroppableItem($event)"
      [notActiveKeys]="notActiveKeys"
      searchText="Поиск..."
    ></pupa-chip-select-tree>
  </pupa-droppable>
</div>

<ng-template #loader>
  <div class="spinner-container">
    <pupa-spinner size="30px"></pupa-spinner>
  </div>
</ng-template>
