@use 'mixins' as *;
@use 'variables' as *;
@use 'functions' as *;
@use 'sass:math';

$width_scrollbar-half: math.div($width_scrollbar, 2);

$width_scrollbar-thumb-large: 5px;
$width_scrollbar_border: 1px;

$padding_scrollbar-thumb-container: math.div(
  ($width_scrollbar - $width_scrollbar-thumb-large - $width_scrollbar_border),
  2
);

$color_light: 'neutral-6';
$color_dark: 'neutral-600';

:host {
  display: block;
  width: 100%;
  height: 100%;
  overflow: auto;
  position: relative;
  scrollbar-gutter: stable;
}

.pupa-scrollable {
  &__scrollbar {
    position: absolute;
    z-index: 2;
    box-sizing: border-box;
    overflow: hidden;
  }

  &__content {
    display: var(--pupa-scrollable-content_display, block);
    flex-direction: var(--pupa-scrollable-content_flex-direction, row);
    padding: var(--pupa-scrollable-content_padding, initial);
    position: relative;
    z-index: 1;

    width: 100%;
    height: 100%;
    max-width: inherit;
    max-height: inherit;
    overflow-x: inherit;
    overflow-y: inherit;
    box-sizing: border-box;

    @include invisible-scrollbars;
  }
}

.pupa-scrollbar {
  &__thumb-container {
    position: absolute;

    box-sizing: border-box;
    border-radius: 11px;
    background-color: color(#{$color_light}, alpha-700);
    cursor: pointer;

    @include supports-backdrop-blur {
      background-color: color(#{$color_light});
    }

    @include host-selector-dark-theme {
      background-color: color(#{$color_dark}, alpha-700);

      @include supports-backdrop-blur {
        background-color: color(#{$color_dark}, alpha-40);
      }
    }

    &__visible-onscroll {
      &:not(.thumb-container_scrolling) {
        .thumb {
          transition: background-color 200ms ease-in;
          background-color: transparent;
          backdrop-filter: none;
        }
      }
    }

    &__grabbing {
      cursor: grabbing;
      border: none;
      background-color: color(#{$color_dark}, alpha-700);
      box-sizing: border-box;

      @include host-selector-dark-theme {
        background-color: color(#{$color_light}, alpha-700);
      }

      &__vertical {
        left: 0px !important;
        width: 11px !important;
        border: none !important;
      }

      &__horizontal {
        top: 0 !important;
        height: 11px !important;
        border: none !important;
      }
    }

    &__vertical {
      left: 1rem;
      width: 5px;
      height: 100%;

      &:hover {
        left: 0;
        width: 11px;
        border: none;
      }
    }

    &__horizontal {
      top: 1rem;
      width: 100%;
      height: 5px;

      &:hover {
        top: 0;
        height: 11px;
        border: none;
      }
    }
  }

  &__vertical {
    width: $width_scrollbar;
    height: 100%;
    right: 0;
    bottom: 0;
    display: none;
    border: 1px solid transparent;
    transform: translateX(100%);

    &__visible {
      display: block;
    }

    &__with-horizontal {
      height: calc(100% - #{$width_scrollbar-half});
      bottom: $width_scrollbar-half;
    }
  }

  &__horizontal {
    width: 100%;
    height: $width_scrollbar;
    right: 0;
    bottom: 0;
    display: none;
    border: 1px solid transparent;

    // transform: tr;

    &__visible {
      display: block;
    }

    &__with-vertical {
      width: calc(100% - #{$width_scrollbar-half});
      right: $width_scrollbar-half;
    }
  }

  &__track {
    position: absolute;
    box-sizing: border-box;
    background-clip: content-box;
    background-color: color(#{$color_light}, alpha-700);
    pointer-events: auto;
    cursor: pointer;

    @include host-selector-dark-theme {
      background-color: color(#{$color_dark}, alpha-700);
    }

    &__vertical {
      left: 6px;
      top: 0;
      width: 1px;
      height: 100%;
    }

    &__horizontal {
      left: 0;
      top: 6px;
      width: 100%;
      height: 1px;
    }
  }
}
